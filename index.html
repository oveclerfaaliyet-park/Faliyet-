<!DOCTYPE html>
<html lang="tr">
<head>
<meta charset="UTF-8">
<title>Park Faaliyet</title>
<meta name="viewport" content="width=device-width, initial-scale=1">
<link rel="manifest" href="manifest.json">
<style>
*{box-sizing:border-box;font-family:sans-serif}
body,html{margin:0;padding:0;height:100%}
.page{display:none;height:100%;background-size:cover;background-position:center}
#home{background-image:url("pexels-eberhardgross-1612351.jpg")}
#add{background-image:url("pexels-skylar-kang-6044198.jpg")}
#settings{background-image:url("pexels-eberhardgross-1301976.jpg")}
.header{background:#fff;padding:10px;position:sticky;top:0}
.card{background:#fff;margin:10px;padding:10px;border-radius:8px}
.card img{width:48%;height:200px;object-fit:cover;border-radius:6px}
#fab{position:fixed;bottom:20px;right:20px;
width:60px;height:60px;border-radius:50%;
background:#2196f3;color:#fff;font-size:40px;
display:flex;align-items:center;justify-content:center}
#loader{position:fixed;top:0;left:0;width:100%;height:100%;
background:#000;color:#fff;display:flex;
align-items:center;justify-content:center;font-size:20px}
video{width:100%;height:100%;object-fit:cover}
</style>
</head>
<body>

<div id="loader">
<video id="intro" src="acilis.mp4" autoplay muted></video>
</div>

<div id="home" class="page">
<div class="header">Park Faaliyet</div>
<div id="list"></div>
</div>

<div id="add" class="page">
<div class="header">Yeni Kayıt</div>
<div class="card">
<input type="date" id="date"><br>
<textarea id="desc" placeholder="Açıklama"></textarea><br>
<input type="file" id="img1" accept="image/*"><br>
<input type="file" id="img2" accept="image/*"><br>
<button onclick="save()">Kaydet</button>
<div id="status"></div>
</div>
</div>

<div id="settings" class="page">
<div class="header">Ayarlar</div>
<div class="card">
PDF ve filtre ileride buraya.
</div>
</div>

<div id="fab" onclick="show('add')">+</div>

<script>
const API = "https://script.google.com/macros/s/AKfycbxAIVyi1HVm-230dheIyVWoYcZr7-8FE9YZNsOWXp1DijEYx39rZ1CW0XZIR7aBURvrJw/exec";
let sending=false;

setTimeout(()=>{document.getElementById("loader").style.display="none";show("home")},15000);
document.body.onclick=()=>document.getElementById("loader").style.display="none";

function show(p){
document.querySelectorAll(".page").forEach(x=>x.style.display="none");
document.getElementById(p).style.display="block";
if(p=="home") load();
}

async function load(){
const res = await fetch(API);
const data = await res.json();
const list = document.getElementById("list");
list.innerHTML="";
data.forEach(r=>{
list.innerHTML+=`
<div class="card">
<div style="display:flex;gap:5px">
<img src="${r.resim1}">
<img src="${r.resim2}">
</div>
<b>${r.tarih}</b><br>${r.aciklama}
</div>`;
});
}

function compress(file){
return new Promise(r=>{
const img=new Image();
img.onload=()=>{
const c=document.createElement("canvas");
c.width=800;c.height=600;
c.getContext("2d").drawImage(img,0,0,800,600);
r(c.toDataURL("image/jpeg",0.5));
};
img.src=URL.createObjectURL(file);
});
}

async function save(){
if(sending) return;
sending=true;
document.getElementById("status").innerText="Kayıt yapılıyor...";

const data={
tarih:date.value,
aciklama:desc.value,
resim1: await compress(img1.files[0]),
resim2: await compress(img2.files[0])
};

fetch(API,{method:"POST",body:JSON.stringify(data)})
.then(r=>r.json()).then(()=>{
document.getElementById("status").innerText="Kaydedildi";
sending=false;
show("home");
});
}
</script>
</body>
</html>
