<!DOCTYPE html>
<html lang="tr">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>PDF Önizleme</title>
<link rel="stylesheet" href="style.css">
<script src="app.js" defer></script>
<style>
.pdfContainer {
    display:grid;
    grid-template-columns:repeat(3,1fr);
    gap:10px;
    padding:10px;
}
.pdfContainer img {
    width:100%;
    height:auto;
    border-radius:3px;
}
</style>
</head>
<body>
<header>
<h1>PDF Önizleme</h1>
<button onclick="window.close()">Kapat</button>
</header>
<main>
<div class="pdfContainer" id="pdfList"></div>
</main>
<script>
async function loadPDF(){
    const params = new URLSearchParams(window.location.search);
    const bas = params.get("bas");
    const bit = params.get("bit");
    const sayfa = params.get("sayfa");

    const res = await fetch(`${SCRIPT_URL}?sayfa=${encodeURIComponent(sayfa)}`);
    const data = await res.json();
    if(data.durum!="ok") return alert(data.mesaj);

    const pdfList = document.getElementById("pdfList");
    pdfList.innerHTML = "";

    const basT = bas ? new Date(bas) : null;
    const bitT = bit ? new Date(bit) : null;

    data.veriler.forEach(row=>{
        const tarih = new Date(row[1]);
        if((!basT || tarih>=basT) && (!bitT || tarih<=bitT)){
            const img = document.createElement("img");
            img.src = row[0];
            pdfList.appendChild(img);
        }
    });
}

loadPDF();
</script>
</body>
</html>
